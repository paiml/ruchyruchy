# Upstream Feedback Reports

This directory contains structured YAML reports for the upstream Ruchy team, generated by the Deep Bug & Performance Discovery system.

## Directory Structure

```
docs/reports/
├── bugs/          # Bug reports (BUG-YYYY-NNN.yaml)
├── performance/   # Performance bottleneck reports (PERF-YYYY-NNN.yaml)
├── suggestions/   # API/language improvement suggestions (SUGG-YYYY-NNN.yaml)
├── regressions/   # Performance/correctness regressions (REGR-YYYY-NNN.yaml)
└── README.md      # This file
```

## Report Types

### Bug Reports (`bugs/BUG-*.yaml`)

Reports compiler bugs discovered through:
- Differential testing
- Metamorphic testing
- Fuzzing
- Property-based testing
- Real-world code injection

**Fields**: ID, severity, category, reproduction, root cause, suggested fix, validation

### Performance Reports (`performance/PERF-*.yaml`)

Reports performance bottlenecks discovered through:
- Profiling (time, memory, allocations)
- Complexity analysis (O(n²) detection)
- Hot function identification
- Comparison with production compiler

**Fields**: ID, category, profiling data, root cause, suggested fix, expected improvement

### Suggestion Reports (`suggestions/SUGG-*.yaml`)

Reports API/language improvements discovered through:
- Real-world code pattern analysis
- Ergonomics issues
- Missing standard library methods
- Consistency improvements

**Fields**: ID, description, usage pattern, proposed implementation, benefits

### Regression Reports (`regressions/REGR-*.yaml`)

Reports performance or correctness regressions detected through:
- CI/CD integration
- Historical comparison
- Bisection

**Fields**: ID, type (perf/correctness), bisection results, impact, suggested fix

## Report Format

All reports use YAML format for:
- ✅ Human-readable (easy manual review)
- ✅ Machine-parseable (automated processing)
- ✅ Schema-validated (consistent structure)
- ✅ Version-controlled (track over time)

## Usage

### For Upstream Ruchy Team

1. **Review Reports**:
   ```bash
   cd docs/reports/bugs
   ls -lt | head -10  # Latest 10 bug reports
   ```

2. **Validate Report**:
   ```bash
   # Check YAML syntax
   yamllint BUG-2025-001.yaml
   ```

3. **Reproduce Bug**:
   ```bash
   # Extract minimal reproduction
   cat BUG-2025-001.yaml | yq '.reproduction.minimal_case' > test.ruchy
   ruchy check test.ruchy  # Should reproduce bug
   ```

4. **Implement Fix**:
   ```bash
   # Extract suggested fix
   cat BUG-2025-001.yaml | yq '.suggested_fix.code'
   ```

5. **Validate Fix**:
   ```bash
   # Run validation steps
   cat BUG-2025-001.yaml | yq '.suggested_fix.validation[]'
   ```

### For RuchyRuchy Developers

1. **Generate Report**:
   ```bash
   ruchydbg auto-detect suspicious_program.ruchy
   # Generates docs/reports/bugs/BUG-YYYY-NNN.yaml
   ```

2. **Performance Report**:
   ```bash
   ruchydbg perf-viz slow_program.ruchy
   # Generates docs/reports/performance/PERF-YYYY-NNN.yaml
   ```

3. **Differential Testing**:
   ```bash
   ruchydbg diff program.ruchy --stages --opt-levels
   # Generates report if divergence detected
   ```

## Report ID Format

Reports use chronological IDs:

- `BUG-YYYY-NNN` - Bug reports (e.g., BUG-2025-001)
- `PERF-YYYY-NNN` - Performance reports (e.g., PERF-2025-001)
- `SUGG-YYYY-NNN` - Suggestion reports (e.g., SUGG-2025-001)
- `REGR-YYYY-NNN` - Regression reports (e.g., REGR-2025-001)

Where:
- `YYYY` = Year (2025)
- `NNN` = Sequential number (001, 002, etc.)

## Quality Metrics

All reports must have:
- ✅ **Minimal reproduction** (<50 LOC preferred)
- ✅ **Root cause analysis** (what, where, why)
- ✅ **Suggested fix** (code diff with explanation)
- ✅ **Validation steps** (how to verify fix works)
- ✅ **Severity assessment** (impact justification)

## Automation

Reports are generated automatically by:
- CI/CD pipeline (on every commit)
- ruchydbg (manual invocation)
- Discovery framework (batch runs)

## Feedback Loop

1. RuchyRuchy discovers bug/performance issue
2. Generate YAML report in docs/reports/
3. Commit report to repository
4. Notify upstream Ruchy team (GitHub issue or PR)
5. Ruchy team reviews, fixes, closes
6. Update report status to "fixed"
7. Verify fix in next Ruchy version

## Examples

See specification document for complete report examples:
- `docs/specifications/deep-bug-performance-discovery-debugger-plan.md`

Example bug report: BUG-2025-001 (Recursive type infinite loop)
Example perf report: PERF-2025-001 (Type checker O(n²) complexity)
Example suggestion: SUGG-2025-001 (Option::transpose() method)

## Schema Validation

All reports should validate against schemas (future):
- `schemas/bug_report.schema.json`
- `schemas/performance_report.schema.json`
- `schemas/suggestion_report.schema.json`
- `schemas/regression_report.schema.json`

---

**Maintained by**: RuchyRuchy Bootstrap Compiler Team
**For questions**: Create issue at https://github.com/paiml/ruchyruchy/issues
**Updated**: October 26, 2025
