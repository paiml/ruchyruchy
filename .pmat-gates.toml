# RuchyRuchy Quality Gate Configuration
# Toyota Way: Jidoka (Built-in Quality) - Stop the line on quality violations
# Generated for: ruchyruchy educational compiler infrastructure

[gates]
# Run clippy linter (Rust only - Ruchy validation separate)
run_clippy = true

# Enforce strict clippy (-D warnings) - Zero tolerance for warnings
clippy_strict = true

# Run Rust test suite (for infrastructure)
run_tests = true

# Test timeout in seconds (5 minutes for fast tests)
test_timeout = 300

# Check code coverage (Rust infrastructure)
check_coverage = true

# Minimum coverage percentage (CLAUDE.md requirement: >80%)
min_coverage = 80.0

# Check cyclomatic complexity (CLAUDE.md requirement: <20 per function)
check_complexity = true

# Maximum cyclomatic complexity per function
max_complexity = 20

[ruchy_validation]
# MANDATORY: All validation code MUST use Ruchy binary tools
# Separate from Rust infrastructure quality gates

# Ruchy test validation (pure .ruchy files)
run_ruchy_test = true
ruchy_test_timeout = 600  # 10 minutes for property/fuzz tests

# Ruchy lint validation (A+ grade required)
run_ruchy_lint = true
require_a_plus_grade = true

# Ruchy formal verification (mathematical proofs)
run_ruchy_prove = true

# Ruchy quality score (>0.8 required)
run_ruchy_score = true
min_ruchy_score = 0.8

# Ruchy performance validation
run_ruchy_runtime = true

[ruchyruchy_debuggers]
# Dogfooding: Validate our own debugging tools
run_ruchydbg_validate = true
ruchydbg_timeout = 360  # 6 minutes (target: <0.013s, allowance for safety)

# Source map validation (1:1 line mapping required)
validate_source_maps = true

# Time-travel debugging validation
validate_time_travel = true

# Performance regression checks
validate_performance = true
max_validation_time_sec = 6  # Target: 0.013s, allow 6s for safety

[book_validation]
# MANDATORY: Book chapters MUST exist for all tickets
# Following ../ruchy-book, ../ruchy, ../paiml-mcp-agent-toolkit patterns
validate_book_chapters = true
require_all_phases = true  # RED, GREEN, REFACTOR, TOOL, DEBUGGER, REPRODUCIBILITY, DEBUGGABILITY
book_build_required = true # mdbook build must succeed

[renacer_validation]
# Performance validation with golden tracing
run_renacer_validate = true
renacer_timeout = 300  # 5 minutes for trace validation

[quality_enforcement]
# Zero tolerance mode (following CLAUDE.md requirements)
fail_on_any_violation = true
block_commits_on_failure = true
allow_bypass = false  # git commit --no-verify FORBIDDEN

# Grace period for new features (allow warnings during RED phase)
grace_period_enabled = false  # Strict enforcement by default
